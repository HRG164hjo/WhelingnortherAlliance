<?xml version="1.0" encoding="utf-8" ?>
<Patch>
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/TraderKindDef[@Name="WNA_TraderKindBase"]/stockGenerators</xpath>
        <value>
            <li Class="StockGenerator_BuyTradeTag"><tag>GravshipUpgrade</tag></li>
            <li Class="StockGenerator_SingleDef">
                <thingDef>Gravcore</thingDef>
                <price>VeryCheap</price>
                <countRange>200000~300000</countRange>
            </li>
            <li Class="StockGenerator_SingleDef">
                <thingDef>GravlitePanel</thingDef>
                <price>VeryCheap</price>
                <countRange>300000~500000</countRange>
            </li>
            <li Class="StockGenerator_SingleDef">
                <thingDef>SentienceCatalyst</thingDef>
                <price>VeryCheap</price>
                <countRange>100000~200000</countRange>
            </li>
            <li Class="StockGenerator_SingleDef">
                <thingDef>ShuttleEngine</thingDef>
                <price>VeryCheap</price>
                <countRange>500000~800000</countRange>
            </li>
            <li Class="StockGenerator_SingleDef">
                <thingDef>BlocksVacstone</thingDef>
                <price>VeryCheap</price>
                <countRange>800000~1000000</countRange>
            </li>
            <li Class="StockGenerator_SingleDef">
                <thingDef>ArcheanSeed</thingDef>
                <price>VeryCheap</price>
                <countRange>100000~200000</countRange>
            </li>
            <li Class="StockGenerator_Tag">
                <tradeTag>GravshipUpgrade</tradeTag>
                <thingDefCountRange>2~2</thingDefCountRange>
                <countRange>10000~20000</countRange>
                <price>VeryCheap</price>
            </li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="Obsidian"]</xpath>
        <value>
            <deepCommonality>0.5</deepCommonality>
            <deepCountPerPortion>45</deepCountPerPortion>
            <deepLumpSizeRange>7~8</deepLumpSizeRange>
        </value>
    </Operation>

    <Operation Class="PatchOperationRemove">
	    <xpath>Defs/ThingDef[defName="Gravcore"]/tradeability</xpath>
    </Operation>

    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="GravEngine"]/statBases/SubstructureSupport</xpath>
        <value>
            <SubstructureSupport>5000</SubstructureSupport>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="GravEngine"]/comps/li[@Class="CompProperties_SubstructureFootprint"]</xpath>
        <value>
            <li Class="CompProperties_SubstructureFootprint">
                <radius>24.9</radius>
            </li>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="GravFieldExtender"]/comps/li[@Class="CompProperties_GravshipFacility"]</xpath>
        <value>
            <li Class="CompProperties_GravshipFacility">
                <statOffsets>
                    <SubstructureSupport>2500</SubstructureSupport>
                </statOffsets>
                <requiresLOS>false</requiresLOS>
                <maxSimultaneous>12</maxSimultaneous>
                <maxDistance>500</maxDistance>
            </li>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="GravFieldExtender"]/comps/li[@Class="CompProperties_SubstructureFootprint"]</xpath>
        <value>
            <li Class="CompProperties_SubstructureFootprint">
                <radius>16.9</radius>
            </li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="GravEngine"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
        <value>
            <li>WNA_UraniumFuelTank</li>
            <li>WNA_ReinforcedThruster</li>
        </value>
    </Operation>
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="GravEngine"]</xpath>
        <value>
            <costList>
                <Gravcore>1</Gravcore>
                <GravlitePanel>75</GravlitePanel>
                <ComponentSpacer>4</ComponentSpacer>
                <Plasteel>150</Plasteel>
            </costList>
            <resourcesFractionWhenDeconstructed>1</resourcesFractionWhenDeconstructed>
            <constructionSkillPrerequisite>8</constructionSkillPrerequisite>
            <designationCategory>Odyssey</designationCategory>
            <useHitPoints>false</useHitPoints>
            <researchPrerequisites>
                <li>BasicGravtech</li>
            </researchPrerequisites>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="FuelOptimizer"]/comps/li[@Class="CompProperties_GravshipFacility"]</xpath>
        <value>
            <li Class="CompProperties_GravshipFacility">
                <fuelSavingsPercent>0.3</fuelSavingsPercent>
                <requiresLOS>false</requiresLOS>
                <maxSimultaneous>3</maxSimultaneous>
                <maxDistance>500</maxDistance>
            </li>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/TerrainDef[defName="Substructure"]/terrainAffordanceNeeded</xpath>
        <value>
            <terrainAffordanceNeeded Inherit="false"/>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="WaspDroneTrap"]</xpath>
        <value>
            <costList>
                <Steel>40</Steel>
                <ComponentIndustrial>1</ComponentIndustrial>
            </costList>
            <designationCategory>Security</designationCategory>
            <constructionSkillPrerequisite>6</constructionSkillPrerequisite>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="AncientFortifiedWall"]/building/deconstructible</xpath>
        <value>
            <deconstructible>true</deconstructible>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="FuelOptimizer" or defName="GravshipShieldGenerator" or defName="OrbitalScanner" or defName="GravcorePowerCell" or defName="SignalJammer" or defName="PilotSubpersonaCore" or defName="GravAnchor"]/statBases/Flammability</xpath>
        <value>
            <Flammability>0</Flammability>
        </value>
    </Operation>
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="FuelOptimizer" or defName="GravshipShieldGenerator" or defName="OrbitalScanner" or defName="GravcorePowerCell" or defName="SignalJammer" or defName="PilotSubpersonaCore" or defName="GravAnchor"]</xpath>
        <value>
            <useHitPoints>false</useHitPoints>
        </value>
    </Operation>
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="GravAnchor" or defName="GravshipShieldGenerator" or defName="FuelOptimizer" or defName="PilotSubpersonaCore"]</xpath>
        <value>
            <designationCategory>Odyssey</designationCategory>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/RitualOutcomeEffectDef[defName="GravshipLaunch"]/comps/li[label="pilot subpersona core"]</xpath>
        <value>
            <li Class="RitualOutcomeComp_GravshipFacilities">
                <label>pilot subpersona core</label>
                <facilityQualityOffsets>
                    <li>
                        <key>PilotSubpersonaCore</key>
                        <value>0.40</value>
                    </li>
                </facilityQualityOffsets>
            </li>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="OrbitalScanner"]</xpath>
        <value>
            <thingCategories>
                <li>BuildingsMisc</li>
            </thingCategories>
            <minifiedDef>MinifiedThing</minifiedDef>
        </value>
    </Operation>
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="OrbitalScanner"]/statBases</xpath>
        <value>
            <Mass>20</Mass>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="GravAnchor"]</xpath>
        <value>
            <minifiedDef>MinifiedGravEngine</minifiedDef>
            <thingCategories>
                <li>BuildingsMisc</li>
            </thingCategories>
        </value>
    </Operation>
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="GravAnchor"]/statBases</xpath>
        <value>
            <Mass>80</Mass>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThoughtDef[defName="BlowingSand" or defName="MadeStatueOfMe"]</xpath>
        <value>
            <nullifyingPrecepts MayRequire="ludeon.rimworld.ideology">
                <li>WNA_P_Proselyte</li>
            </nullifyingPrecepts>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationRemove">
	    <xpath>Defs/WorldObjectDef/requiresSignalJammerToReach</xpath>
    </Operation>
    
    <Operation Class="PatchOperationRemove">
	    <xpath>Defs/ThingDef[defName="GravshipShieldGenerator"]/comps/li[@Class="CompProperties_Interactable"]</xpath>
    </Operation>
    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="GravshipShieldGenerator"]/specialDisplayRadius</xpath>
        <value>
            <specialDisplayRadius>27.9</specialDisplayRadius>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
	    <xpath>Defs/ThingDef[defName="GravshipShieldGenerator"]/comps/li[@Class="CompProperties_ProjectileInterceptor"]</xpath>
        <value>
            <li Class="CompProperties_ProjectileInterceptor">
                <radius>27.9</radius>
                <cooldownTicks>0</cooldownTicks>
                <disarmedByEmpForTicks>0</disarmedByEmpForTicks>
                <interceptGroundProjectiles>true</interceptGroundProjectiles>
                <interceptAirProjectiles>true</interceptAirProjectiles>
                <interceptNonHostileProjectiles>false</interceptNonHostileProjectiles>
                <interceptOutgoingProjectiles>false</interceptOutgoingProjectiles>
                <drawWithNoSelection>true</drawWithNoSelection>
                <chargeDurationTicks>1</chargeDurationTicks>
                <rechargeHitPointsIntervalTicks>1</rechargeHitPointsIntervalTicks>
                <color>(0.4,0.4,0.4)</color>
                <minIdleAlpha>0.2</minIdleAlpha>
                <activeSound>BulletShield_Ambience</activeSound>
            </li>
        </value>
    </Operation>
    
    <Operation Class="PatchOperationRemove">
	    <xpath>Defs/ThingDef[defName="MechPylon"]/building/deconstructible</xpath>
    </Operation>
    <Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="MechPylon"]</xpath>
        <value>
            <costList>
                <ChunkMechanoidSlag>2</ChunkMechanoidSlag>
                <GravlitePanel>15</GravlitePanel>
            </costList>
		    <resourcesFractionWhenDeconstructed>1</resourcesFractionWhenDeconstructed>
        </value>
    </Operation>
</Patch>